<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Custom docker</title>
    <meta name="description" content="">
    <link rel="icon" href="/logo.svg">
    
    <link rel="preload" href="/assets/css/0.styles.7b9d5d88.css" as="style"><link rel="preload" href="/assets/js/app.69da0abf.js" as="script"><link rel="preload" href="/assets/js/10.00676417.js" as="script"><link rel="prefetch" href="/assets/js/5.381e71df.js"><link rel="prefetch" href="/assets/js/2.178aa6c2.js"><link rel="prefetch" href="/assets/js/3.74f02869.js"><link rel="prefetch" href="/assets/js/4.37d8023c.js"><link rel="prefetch" href="/assets/js/6.2f341fc7.js"><link rel="prefetch" href="/assets/js/7.608221bf.js"><link rel="prefetch" href="/assets/js/8.13329ccf.js"><link rel="prefetch" href="/assets/js/9.65f6aa22.js"><link rel="prefetch" href="/assets/js/11.26329b69.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b9d5d88.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://vapor.cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vapor Cloud website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://vapor.cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vapor Cloud website
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/reference/" class="sidebar-link">Reference</a></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Deployment</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/reference/vapor-cloud-git.html" class="sidebar-link">Vapor Cloud GIT</a></li><li><a href="/reference/custom-docker.html" class="active sidebar-link">Custom docker</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="custom-docker"><a href="#custom-docker" aria-hidden="true" class="header-anchor">#</a> Custom docker</h1> <div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>This page is still work in progress</p></div> <p>Vapor Cloud is built using very scalable Docker templates for running Vapor. But sometimes you can experience cases where you want to change the Docker template, either because you need some major changes to the template, or simply want to run something different from Vapor, for example a VueJS frontend application for your Vapor app.</p> <p>To accomplish this, you can easily change the Docker template used by the deployment process.
Setting up custom docker template</p> <p>Start by adding a Dockerfile in your application root. The Vapor Cloud docker setup supports Multi-step docker build.
Here is an example of a VueJS template using NGinx</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># build stage</span>
<span class="token keyword">FROM</span> node<span class="token punctuation">:</span>9.11.1<span class="token punctuation">-</span>alpine as build<span class="token punctuation">-</span>stage
<span class="token keyword">WORKDIR</span> /app
<span class="token keyword">COPY</span> package*.json ./
<span class="token keyword">RUN</span> npm install
<span class="token keyword">COPY</span> . .
<span class="token keyword">RUN</span> npm run build

<span class="token comment"># production stage</span>
<span class="token keyword">FROM</span> nginx<span class="token punctuation">:</span>1.13.12<span class="token punctuation">-</span>alpine as production<span class="token punctuation">-</span>stage
<span class="token keyword">COPY</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>from=build<span class="token punctuation">-</span>stage /app/dist /usr/share/nginx/html/dist
<span class="token keyword">COPY</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>from=build<span class="token punctuation">-</span>stage /app/index.html /usr/share/nginx/html
<span class="token keyword">COPY</span> <span class="token punctuation">-</span><span class="token punctuation">-</span>from=build<span class="token punctuation">-</span>stage /app/public /usr/share/nginx/html/public
<span class="token keyword">RUN</span> chown <span class="token punctuation">-</span>R nginx<span class="token punctuation">:</span>nginx /usr/share/nginx/html/
<span class="token keyword">EXPOSE</span> 80
<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;nginx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-g&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;daemon off;&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/10.00676417.js" defer></script><script src="/assets/js/app.69da0abf.js" defer></script>
  </body>
</html>
